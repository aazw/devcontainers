{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended"],
  "labels": ["Renovate"],
  "assignees": ["aazw"],
  "prHourlyLimit": 0,
  "prConcurrentLimit": 10,
  "minimumReleaseAge": "7 days",
  "ignorePaths": [],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update _VERSION variables in Dockerfiles",
      "fileMatch": ["Dockerfile"],
      "matchStrings": [
        "# renovate: datasource=(?<datasource>[a-z-]+?)(?: depName=(?<depName>.+?))? packageName=(?<packageName>.+?)(?: versioning=(?<versioning>[a-z-0-9.-]+?))?\\s(?:ENV|ARG) .+?_VERSION=(?<currentValue>.+?)\\s"
      ]
    }
  ],
  "packageRules": [
    {
      "description": "Debian packages' registries",
      "matchDatasources": ["deb"],
      "registryUrls": [
        "https://deb.debian.org/debian?suite=bookworm&components=main,contrib,non-free,non-free-firmware&binaryArch=amd64",
        "https://deb.debian.org/debian?suite=bookworm&components=main,contrib,non-free,non-free-firmware&binaryArch=arm64",
        "https://deb.debian.org/debian?suite=bookworm-updates&components=main,contrib,non-free,non-free-firmware&binaryArch=amd64",
        "https://deb.debian.org/debian?suite=bookworm-updates&components=main,contrib,non-free,non-free-firmware&binaryArch=arm64",
        "https://security.debian.org/debian-security?suite=bookworm-security&components=main,contrib,non-free,non-free-firmware&binaryArch=amd64",
        "https://security.debian.org/debian-security?suite=bookworm-security&components=main,contrib,non-free,non-free-firmware&binaryArch=arm64"
      ]
    },
    {
      "description": "Separate devcontainers/base updates by image directory",
      "matchPaths": ["**/images/*/.devcontainer/Dockerfile"],
      "matchDatasources": ["docker"],
      "matchPackageNames": ["ghcr.io/aazw/devcontainers/base"],
      "versioning": "regex:^(?<major>\\d+)$",
      "groupName": "devcontainers/base image: {{packageFile}}",
      "labels": ["{{packageFile}}", "devcontainers/base"]
    },
    {
      "description": "Group docker images - major updates by image directory",
      "matchPaths": ["**/images/*/.devcontainer/Dockerfile"],
      "matchDatasources": ["docker"],
      "excludePackageNames": ["ghcr.io/aazw/devcontainers/base"],
      "matchUpdateTypes": ["major"],
      "groupName": "docker images (major) : {{packageFile}}",
      "labels": ["{{packageFile}}", "docker images (major)"]
    },
    {
      "description": "Group docker images - minor/patch updates by image directory",
      "matchPaths": ["**/images/*/.devcontainer/Dockerfile"],
      "matchDatasources": ["docker"],
      "excludePackageNames": ["ghcr.io/aazw/devcontainers/base"],
      "matchUpdateTypes": ["minor", "patch"],
      "groupName": "docker images (minor/patch) : {{packageFile}}",
      "labels": ["{{packageFile}}", "docker images (minor/patch)"]
    },
    {
      "description": "Group packages - major updates by image directory",
      "matchPaths": ["**/images/*/.devcontainer/Dockerfile"],
      "matchDatasources": [
        "deb",
        "go",
        "crate",
        "npm",
        "pypi",
        "github-releases",
        "github-tags"
      ],
      "matchUpdateTypes": ["major"],
      "groupName": "packages (major) : {{packageFile}}",
      "labels": ["{{packageFile}}", "packages (major)"]
    },
    {
      "description": "Group packages - minor/patch updates by image directory",
      "matchPaths": ["**/images/*/.devcontainer/Dockerfile"],
      "matchDatasources": [
        "deb",
        "go",
        "crate",
        "npm",
        "pypi",
        "github-releases",
        "github-tags"
      ],
      "matchUpdateTypes": ["minor", "patch"],
      "groupName": "packages (minor/patch) : {{packageFile}}",
      "labels": ["{{packageFile}}", "packages (minor/patch)"]
    }
  ]
}
