{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended"],
  "labels": ["Renovate"],
  "assignees": ["aazw"],
  "prHourlyLimit": 0,
  "prConcurrentLimit": 10,
  "minimumReleaseAge": "7 days",
  "ignorePaths": [],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update _VERSION variables in Dockerfiles",
      "fileMatch": ["/(^|/|\\.)Dockerfile$/", "/(^|/)Dockerfile\\.[^/]*$/"],
      "matchStrings": [
        "# renovate: datasource=(?<datasource>[a-z-]+?)(?: depName=(?<depName>.+?))? packageName=(?<packageName>.+?)(?: versioning=(?<versioning>[a-z-]+?))?\\s(?:ENV|ARG) .+?_VERSION=(?<currentValue>.+?)\\s"
      ]
    }
  ],
  "packageRules": [
    {
      "description": "Debian packages' registries",
      "matchDatasources": ["deb"],
      "registryUrls": [
        "https://deb.debian.org/debian?suite=bookworm&components=main,contrib,non-free,non-free-firmware&binaryArch=amd64",
        "https://deb.debian.org/debian?suite=bookworm&components=main,contrib,non-free,non-free-firmware&binaryArch=arm64",
        "https://deb.debian.org/debian?suite=bookworm-updates&components=main,contrib,non-free,non-free-firmware&binaryArch=amd64",
        "https://deb.debian.org/debian?suite=bookworm-updates&components=main,contrib,non-free,non-free-firmware&binaryArch=arm64",
        "https://security.debian.org/debian-security?suite=bookworm-security&components=main,contrib,non-free,non-free-firmware&binaryArch=amd64",
        "https://security.debian.org/debian-security?suite=bookworm-security&components=main,contrib,non-free,non-free-firmware&binaryArch=arm64"
      ]
    },
    {
      "description": "Separate devcontainers/base updates by image directory",
      "matchPaths": ["**/images/*/.devcontainer/Dockerfile"],
      "matchPackageNames": ["ghcr.io/aazw/devcontainers/base"],
      "groupName": "{{parentDir}}: devcontainers/base"
    },
    {
      "description": "Group base images - major updates by image directory",
      "matchPaths": ["**/images/*/.devcontainer/Dockerfile"],
      "matchPackageNames": ["golang", "rust", "node", "python"],
      "matchUpdateTypes": ["major"],
      "groupName": "{{parentDir}}: base images (major)"
    },
    {
      "description": "Group base images - minor/patch updates by image directory",
      "matchPaths": ["**/images/*/.devcontainer/Dockerfile"],
      "matchPackageNames": ["golang", "rust", "node", "python"],
      "matchUpdateTypes": ["minor", "patch"],
      "groupName": "{{parentDir}}: base images (minor/patch)"
    },
    {
      "description": "Group packages - major updates by image directory",
      "matchPaths": ["**/images/*/.devcontainer/Dockerfile"],
      "matchDatasources": [
        "go",
        "crate",
        "npm",
        "pypi",
        "github-releases",
        "github-tags"
      ],
      "matchUpdateTypes": ["major"],
      "groupName": "{{parentDir}}: packages (major)"
    },
    {
      "description": "Group packages - minor/patch updates by image directory",
      "matchPaths": ["**/images/*/.devcontainer/Dockerfile"],
      "matchDatasources": [
        "go",
        "crate",
        "npm",
        "pypi",
        "github-releases",
        "github-tags"
      ],
      "matchUpdateTypes": ["minor", "patch"],
      "groupName": "{{parentDir}}: packages (minor/patch)"
    }
  ]
}
